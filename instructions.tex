\documentclass[a4paper]{article}
\usepackage[numbers]{natbib}
\usepackage{listings}
\usepackage[hidelinks]{hyperref}
\usepackage[T1]{fontenc} %Stops attempting to use speech marks in code listings.
\lstset{
    columns=fullflexible,
    basicstyle=\ttfamily,
    frame=single,
    breaklines=true,
}

\title{Arch Linux Post-Install}
\author{Wartybix}
\date{\today}

\begin{document}

\maketitle

These are some notes I have written for myself, for the next time I install Arch Linux.

\section{Using Pacman}

Install new packages with:
\begin{lstlisting}[escapechar=@]
# pacman -Syu @\underline{packagename}@
\end{lstlisting}
Passing the \lstinline|-Syu| flag updates all packages on the system, and is necessary to prevent any breakage from incompatible packages.
Check the manual page (\lstinline|man pacman|) for more information on what each of these 
flags do.

Remove packages with:
\begin{lstlisting}[escapechar=@]
# pacman -R @\underline{packagename}@
\end{lstlisting}

\section{Bash Autocomplete}

On a fresh installation of Arch Linux, the terminal doesn't always auto-complete when pressing tab while inputting package names and such.
Install the \lstinline|bash-completion| package for this functionality (\lstinline|pacman -Syu bash-completion|).

\section{Installing Yay}

To make management of AUR packages easier, Yay should be installed.
On a fresh install of Arch Linux, Git may not be installed --- in which case install it.
\begin{lstlisting}
# pacman -Syu git
\end{lstlisting}
Clone Yay's repository located at \url{https://aur.archlinux.org/yay.git}:
\begin{lstlisting}
$ git clone https://aur.archlinux.org/yay.git
\end{lstlisting}
Navigate into the new directory:
\begin{lstlisting}
$ cd yay
\end{lstlisting}
Install Yay:
\begin{lstlisting}
$ makepkg -si
\end{lstlisting}
Yay is now installed.

\section{Update Notifier}

This step is only helpful if using the GNOME desktop environment.

Get informed of updates for your system without needing to manually check yourself in the terminal.
To enable this functionality, install the Arch Linux Updates Indicator (\lstinline|arch-update@RaphaelRochet|) GNOME extension.

Disable the `Always visible' option in its settings to only show the update icon when new updates are available.

\subsection*{Implementing with Yay}

By default, the extension only works with packages using Pacman.
Extend this functionality to Yay to allow the notifications and upgrades of new AUR package updates.
The following commands are as per the project's wiki (\url{https://github.com/RaphaelRochet/arch-update/wiki}).

In `Advanced Settings' of the extension's settings, change `Command to check for package updates' to:
\begin{lstlisting}
/bin/sh -c "(/usr/bin/checkupdates; /usr/bin/yay -Qu --color never | sed 's/Get .*//') | sort -u -t' ' -k1,1"
\end{lstlisting}
And change `Command to update packages' to:
\begin{lstlisting}
kgx -e '/bin/sh -c "yay ; echo Done - Press enter to exit; read"'
\end{lstlisting}

\section{Setting up Pacman cache auto-clean}

Pacman's cache of previous package versions will build up over time.
To clear this cache on a weekly basis, enable and start \lstinline|paccache.timer| \cite{paccache-timer}.

\begin{lstlisting}
# systemctl enable paccache.timer
# systemctl start paccache.timer
\end{lstlisting}

\section{Setting up secure boot}

Thank you to `Walian' on YouTube for an easy-to-follow guide on enabling secure boot on Arch Linux (\url{https://www.youtube.com/watch?v=yU-SE7QX6WQ}).
I have written the following instructions from this video here in order to preserve them, and to allow the following of these instructions in a textual manner.

Reboot into your motherboard's BIOS, either by entering your motherboard's assigned `BIOS key' on boot, or by entering the following in a Linux terminal:
\begin{lstlisting}
$ systemctl reboot --firmware-setup
\end{lstlisting}

In the BIOS, disable secure boot (if not disabled already), and reset your secure boot keys.
Save changes and reboot.

Install the \lstinline|sbctl| package:
\begin{lstlisting}
# pacman -Syu sbctl
\end{lstlisting}

Create secure boot keys with:
\begin{lstlisting}
# sbctl create-keys
\end{lstlisting}

Enroll the keys with your system with:
\begin{lstlisting}
# sbctl enroll-keys -m
\end{lstlisting}

Sign the bootloader with:
\begin{lstlisting}
# sbctl sign -s -o /usr/lib/systemd/boot/efi/systemd-bootx64.efi.signed /usr/lib/systemd/boot/efi/systemd-bootx64.efi
\end{lstlisting}

Find the location of your kernel image with:
\begin{lstlisting}
# cat /etc/mkinitcpio.d/linux.preset 
\end{lstlisting}

The location of the kernel image to sign is listed as \lstinline|ALL_kver=|.
This location will most likely be \lstinline|/boot/vmlinuz-linux|.
If using a unified kernel image, the kernel image to sign is listed as \lstinline|default_uki=|, which will most likely be \lstinline|/efi/EFI/Linux/arch-linux.efi|.

Sign the kernel image:
\begin{lstlisting}
# sbctl sign -s /boot/vmlinuz-linux
\end{lstlisting}
If using a unified kernel image:
\begin{lstlisting}
# sbctl sign -s /efi/EFI/Linux/arch-linux.efi
\end{lstlisting}
If using an LTS kernel image:
\begin{lstlisting}
# sbctl sign -s /boot/vmlinuz-linux-lts
\end{lstlisting}

Reinstall the bootloader:
\begin{lstlisting}
# bootctl install
\end{lstlisting}

Ensure all files have been signed correctly with:
\begin{lstlisting}
# sbctl verify
\end{lstlisting}

If everything is signed and there are no issues, reboot back into the BIOS and enable secure boot.

\section{Terminal linting}

\section{Gaming on Linux}

\bibliographystyle{IEEEtranN}
\bibliography{refs}

\end{document}